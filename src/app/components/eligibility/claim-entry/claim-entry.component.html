<div class="title-page">
  <div class="breadcrumb-container">
    <nz-breadcrumb>
      <nz-breadcrumb-item>Mar Chiquita</nz-breadcrumb-item>
      <nz-breadcrumb-item>Patients</nz-breadcrumb-item>
      <nz-breadcrumb-item>Patient Management</nz-breadcrumb-item>
      <nz-breadcrumb-item>Claims Entry</nz-breadcrumb-item>
    </nz-breadcrumb>
  </div>
</div>

<div #childContent>
  <nz-card [nzTitle]="'HEALTH INSURANCE CLAIM FORM ' + (isViewMode ? claimDataView?.id_claim : '')"
    [nzBordered]="true" 
    class="main-card">
    <nz-spin [nzSpinning]="modalLoader">
      <form nz-form [formGroup]="form" (submit)="submit()">
        <nz-row [nzGutter]="16">
          <nz-col [nzSpan]="5">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="insurance_type">
                1. Insurance Type
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <nz-select 
                  style="width: 100%;" 
                  nzShowSearch
                  id="insurance_type"
                  nzPlaceHolder="Select Insurance Type"
                  formControlName="insurance_type">
                  <nz-option 
                    *ngFor="let option of insuranceTypeOptions"
                    [nzLabel]="option.label" 
                    [nzValue]="option.value">
                  </nz-option>  
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </nz-col>
        
          <nz-col [nzSpan]="5">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="insured_id">
                1a. Insured ID Number
              </nz-form-label>

              <nz-form-control
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input
                  id="insured_id"
                  formControlName="insured_id"
                  readonly
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="6">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="patient_name">
                2. Patient's Name
              </nz-form-label>

              <nz-form-control
                [nzErrorTip]="errorTemplate" 
                [nzSpan]="24">
                <input 
                  nz-input
                  id="patient_name"
                  formControlName="patient_name"
                  readonly
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="patient_birth_date">
                3. Patient's Birth Date
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                nz-input
                id="patient_birth_date"
                [value]="form.get('patient_birth_date')?.value | date: 'MM-dd-yyyy'"
                readonly
              />          
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="patient_gender">
                3. Patient's Gender
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input
                  id="patient_gender"
                  formControlName="patient_gender"
                  readonly
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>
        </nz-row>
          
        <nz-row [nzGutter]="16">
          <nz-col [nzSpan]="6">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24"
                nzFor="patient_address">
                5. Patient's Address
              </nz-form-label>

              <nz-form-control
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input 
                  id="patient_address" 
                  formControlName="patient_address" 
                  readonly 
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>
        
          <nz-col [nzSpan]="6">
            <nz-form-item>
              <nz-form-label
                [nzSpan]="24"
                nzFor="patient_city">
                5. Patient's City
              </nz-form-label>

              <nz-form-control
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input 
                  id="patient_city" 
                  formControlName="patient_city" 
                  readonly 
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>
        
          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24"
                nzFor="patient_state">
                5. Patient's State
              </nz-form-label>
              
              <nz-form-control
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input 
                  id="patient_state" 
                  formControlName="patient_state" 
                  readonly 
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>
        
          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24"
                nzFor="patient_zip_code">
                5. Patient's Zip Code
              </nz-form-label>

              <nz-form-control
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input 
                  id="patient_zip_code" 
                  formControlName="patient_zip_code" 
                  readonly 
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24"
                nzFor="patient_phone">
                5. Patient's Phone
              </nz-form-label>

              <nz-form-control
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input 
                  id="patient_phone" 
                  formControlName="patient_phone" 
                  readonly 
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>
        </nz-row>
        
        <nz-row [nzGutter]="16">
          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="relationship">
                6. Patient's Relationship To Insured
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <nz-select 
                  style="width: 100%;" 
                  nzShowSearch 
                  id="relationship"
                  nzPlaceHolder="Select Relationship"
                  formControlName="relationship">
                  <nz-option 
                    nzLabel="SELF" [nzValue]="1" selected>
                  </nz-option>
                  <nz-option 
                    nzLabel="SPOUSE" [nzValue]="2">
                  </nz-option>
                  <nz-option 
                    nzLabel="CHILD" [nzValue]="3">
                  </nz-option>
                  <nz-option 
                    nzLabel="OTHER" [nzValue]="4">
                  </nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="insured_police_group_feca">
                11. Insured's Police Group Or Feca
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input
                  id="insured_police_group_feca"
                  formControlName="insured_police_group_feca"
                  readonly
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="insured_date_birth">
                11a. Insured's Date of Birth
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input
                  id="insured_date_birth"
                  [value]="form.get('insured_date_birth')?.value | date: 'MM-dd-yyyy'"
                  readonly
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="insured_gender">
                11b. Insured's Gender
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input
                  id="insured_gender"
                  formControlName="insured_gender"
                  readonly
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="insured_insurance_plan_name">
                11c. Insured's Insurance Plan Name
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input
                  id="insured_insurance_plan_name"
                  formControlName="insured_insurance_plan_name"
                  readonly
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="patient_signature">
                12. Patient's Signature
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <nz-select 
                  style="width: 100%;" 
                  id="patient_signature"
                  nzPlaceHolder="Select Patient's Signature"
                  formControlName="patient_signature">
                  <nz-option 
                    *ngFor="let option of signatureOptions"
                    [nzLabel]="option.label" 
                    [nzValue]="option.value">
                  </nz-option>      
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </nz-col>
        </nz-row>

        <nz-row [nzGutter]="16">
          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="date_service">
                12. Date Service
              </nz-form-label>
              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <ng-container *ngIf="isViewMode; else editDateService">
                  <input
                    nz-input
                    readonly
                    [value]="form.get('date_service')?.value | date:'MM-dd-YYYY'"
                  />
                </ng-container>
                <ng-template #editDateService>
                  <nz-date-picker
                    style="width: 100%"
                    nzFormat="MM-dd-YYYY"
                    formControlName="date_service"
                    [nzDisabledDate]="disabledDate">
                  </nz-date-picker>
                </ng-template>
              </nz-form-control>
            </nz-form-item>
          </nz-col>          

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="insured_signature">
                13. Insured's Signature
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <nz-select 
                  style="width: 100%;" 
                  id="insured_signature"
                  nzPlaceHolder="Insured's Signature"
                  formControlName="insured_signature">
                  <nz-option 
                    *ngFor="let option of signatureOptions"
                    [nzLabel]="option.label" 
                    [nzValue]="option.value">
                  </nz-option>   
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="name_referring_provider">
                17. Name or Referring Provider
              </nz-form-label>

              <nz-form-control 
                [nzSpan]="24">
                <input 
                  nz-input 
                  [readOnly]="isViewMode"
                  id="name_referring_provider" 
                  formControlName="name_referring_provider" 
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>
        
          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="name_referring_provider_npi">
                17b. Name or Referring Provider NPI
              </nz-form-label>

              <nz-form-control 
                [nzSpan]="24"
                [nzErrorTip]="errorTemplate">
                <input 
                  nz-input 
                  [readOnly]="isViewMode"
                  id="name_referring_provider_npi" 
                  formControlName="name_referring_provider_npi" 
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="original_ref_number">
                22b. Original Ref. Number
              </nz-form-label>

              <nz-form-control 
                [nzSpan]="24">
                <input 
                  nz-input 
                  [readOnly]="isViewMode"
                  id="original_ref_number" 
                  formControlName="original_ref_number" 
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="prior_authorization_number">
                23. Prior Authorization Number
              </nz-form-label>

              <nz-form-control 
                [nzSpan]="24">
                <input 
                  nz-input 
                  [readOnly]="isViewMode"
                  id="prior_authorization_number" 
                  formControlName="prior_authorization_number" 
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>
        </nz-row>

        <nz-row 
          nzJustify="center" 
          *ngIf="!isViewMode">
          <nz-col>
            <button 
              nz-button 
              type="button"
              nzType="primary" 
              nzIcon="plus"
              style="margin-bottom: 16px;"
              (click)="addDiagnosis()">
              Add diagnosis
            </button>
          </nz-col>
        </nz-row>    

        <div formArrayName="diagnosis">
          <nz-row nzJustify="center" *ngIf="isViewMode">
            <p>Diagnosis</p>
          </nz-row>
          <nz-row [nzGutter]="16">
            <nz-col
              [nzSpan]="6"
              style="margin-bottom: 16px;"
              *ngFor="let diagCtrl of diagnosisControls.controls; let i = index">
              <nz-form-item>            
                <nz-form-control
                  [nzHasFeedback]="true"
                  [nzValidateStatus]="getDiagnosisStatus(diagCtrl)"
                  [nzSpan]="24">
                  <ng-container *ngIf="isViewMode; else editDiagnosis">
                    <input
                      nz-input
                      readonly
                      [value]="getDiagnosisLabel(diagCtrl.value)"
                      [placeholder]="'Diag ' + (i + 1)" />
                  </ng-container>

                  <ng-template #editDiagnosis>
                    <nz-select
                      nzShowSearch
                      [formControlName]="i"
                      [nzOptions]="diagnosisOptions"
                      style="width: 100%"
                      [nzSuffixIcon]="deleteIcon"
                      [nzPlaceHolder]="'Diag ' + (i + 1)">
                    </nz-select>

                    <ng-template #deleteIcon>
                      <i
                        nz-icon
                        nzType="delete"
                        nzTheme="twotone"
                        *ngIf="!isViewMode && i !== 0"
                        (click)="removeDiagnosis(i)"
                        style="cursor: pointer">
                      </i>
                    </ng-template>
                  </ng-template>
                </nz-form-control>
              </nz-form-item>
            </nz-col>
          </nz-row>
        </div>      
          
        <div class="table-container">
          <nz-table 
            [nzData]="rowsControls.controls" 
            [nzSize]="'small'" 
            [nzFrontPagination]="false">
            <thead>
              <tr>
                <th nzWidth="150px">Date Initial</th>
                <th nzWidth="150px">Date Final</th>
                <th>Place of Service</th>
                <th nzWidth="110px">Emg</th>
                <th>Procedures (CPT)</th>
                <th 
                  nzWidth="400px" 
                  *ngIf="claimData?.modifiers == '1' || 
                  claimDataView?.modifiers == '1'">
                  Modifiers
                </th>
                <th>Diagnosis pointer</th>
                <th nzWidth="100px">Charges</th>
                <th nzWidth="80px">Days Unit</th>
                <th>Rendering Provider ID</th>
                <th *ngIf="!isViewMode">Action</th>
              </tr>
            </thead>
            <tbody formArrayName="rows">
              <tr *ngFor="let rowCtrl of rowsControls.controls; let i = index" [formGroupName]="i">
                <td>
                  <nz-form-control 
                    [nzHasFeedback]="hasFeedback('rows.' + i + '.date_initial')">
                    <ng-container *ngIf="isViewMode; else editDateInitial">
                      <input
                        nz-input
                        readonly
                        [value]="rowCtrl.get('date_initial')?.value | date:'MM-dd-yyyy'"
                      />
                    </ng-container>
                    <ng-template #editDateInitial>
                      <nz-date-picker
                        style="width: 100%"
                        nzFormat="MM-dd-yyyy"
                        formControlName="date_initial"
                        [nzDisabledDate]="disabledDate">
                      </nz-date-picker>
                    </ng-template>
                  </nz-form-control>
                </td>                        
                <td>
                  <nz-form-control 
                    [nzHasFeedback]="hasFeedback('rows.' + i + '.date_final')">
                    <ng-container *ngIf="isViewMode; else editDateFinal">
                      <input
                        nz-input
                        readonly
                        [value]="rowCtrl.get('date_final')?.value | date:'MM-dd-yyyy'"
                      />
                    </ng-container>
                    <ng-template #editDateFinal>
                      <nz-date-picker
                        style="width: 100%"
                        nzFormat="MM-dd-yyyy"
                        formControlName="date_final"
                        [nzDisabledDate]="disabledFinalDate">
                      </nz-date-picker>
                    </ng-template>
                  </nz-form-control>
                </td>              
                <td>
                  <nz-form-control 
                    [nzHasFeedback]="hasFeedback('rows.' + i + '.place_of_service')">
                    <ng-container *ngIf="isViewMode; else editPlaceService">
                      <input
                        nz-input
                        readonly
                        formControlName="place_of_service"
                      />
                    </ng-container>
                    <ng-template #editPlaceService>
                      <nz-select
                        formControlName="place_of_service"
                        [nzOptions]="placeServicesOptions"
                        style="width: 100%">
                      </nz-select>
                    </ng-template>
                  </nz-form-control>
                </td>                         
                <td>
                  <nz-form-control 
                    [nzHasFeedback]="hasFeedback('rows.' + i + '.emg')">
                    <ng-container *ngIf="isViewMode; else editEmg">
                      <input
                        nz-input
                        readonly
                        [value]="getEmgLabel(rowCtrl.get('emg')?.value)"
                      />
                    </ng-container>
                    <ng-template #editEmg>
                      <nz-select 
                        formControlName="emg" 
                        nzPlaceHolder="Select Emg">
                        <nz-option 
                          nzValue="1" 
                          nzLabel="YES">
                        </nz-option>
                        <nz-option 
                          nzValue="2" 
                          nzLabel="NO">
                        </nz-option>
                      </nz-select>
                    </ng-template>
                  </nz-form-control>
                </td>              
                <td>
                  <nz-form-control 
                    [nzHasFeedback]="hasFeedback('rows.' + i + '.procedures')">
                    <ng-container *ngIf="isViewMode; else editProcedure">
                      <input
                        nz-input
                        readonly
                        formControlName="procedures"
                      />
                    </ng-container>
                    <ng-template #editProcedure>
                      <nz-select
                        formControlName="procedures"
                        nzShowSearch
                        style="width: 100%"
                        (ngModelChange)="onProcedureSelected($event, rowCtrl)"
                        [nzOptions]="codeOptions">
                      </nz-select>
                    </ng-template>
                  </nz-form-control>
                </td>                       
                <td *ngIf="claimData?.modifiers == '1' || claimDataView?.modifiers == '1'">
                  <div formArrayName="modifiers" nz-row [nzGutter]="8">
                    <ng-container 
                      *ngFor="let modifierCtrl of getModifiersControls(rowCtrl); 
                      let j = index" [formGroupName]="j">
                      <nz-col [nzSpan]="6">
                        <nz-form-control 
                          [nzHasFeedback]="true"
                          [nzValidateStatus]="getModifierStatus(rowCtrl, modifierCtrl)">
                          <ng-container *ngIf="isViewMode; else editModifier">
                            <input
                              nz-input
                              readonly
                              [value]="getModifierLabel(modifierCtrl.get('value')?.value)" />
                          </ng-container>
                          <ng-template #editModifier>
                            <nz-select
                              formControlName="value"
                              nzAllowClear
                              nzShowSearch
                              (ngModelChange)="onModifierChange(rowCtrl)">
                              <nz-option
                                *ngFor="let option of modifiersOptions"
                                [nzValue]="option.value"
                                [nzLabel]="option.label">
                              </nz-option>
                            </nz-select>
                          </ng-template>
                        </nz-form-control>
                      </nz-col>
                    </ng-container>
                  </div>
                </td>              
                <td>
                  <nz-form-control 
                    [nzHasFeedback]="hasFeedback('rows.' + i + '.diagnosis_pointer')">
                    <ng-container 
                      *ngIf="isViewMode; else selectDiagnosis">
                      <input 
                        nz-input 
                        type="text"
                        formControlName="diagnosis_pointer"
                        readonly
                      />
                    </ng-container>
                    <ng-template #selectDiagnosis>
                      <nz-select 
                        formControlName="diagnosis_pointer">
                        <nz-option
                          *ngFor="let option of diagnosisPointerOptionsCache"
                          [nzValue]="option.value"
                          [nzLabel]="option.label">
                        </nz-option>
                      </nz-select>
                    </ng-template>
                  </nz-form-control>
                </td>                             
                <td>
                  <nz-form-control 
                    [nzHasFeedback]="hasFeedback('rows.' + i + '.charges')">
                    <input 
                      nz-input 
                      type="number" 
                      formControlName="charges"
                      readonly
                      (ngModelChange)="calculateTotalCharges()" 
                    />
                  </nz-form-control>
                </td>
                <td>
                  <nz-form-control 
                    [nzHasFeedback]="hasFeedback('rows.' + i + '.units')">
                    <input 
                      nz-input 
                      type="number" 
                      [readonly]="isViewMode"
                      formControlName="units" 
                    />
                  </nz-form-control>
                </td>
                <td>
                  <nz-form-control 
                    [nzHasFeedback]="hasFeedback('rows.' + i + '.rendering_provider_id')">
                    <input 
                      nz-input 
                      formControlName="rendering_provider_id" 
                      readonly 
                    />
                  </nz-form-control>
                </td>
                <td *ngIf="!isViewMode">
                  <a>
                    <span 
                      nz-icon 
                      title="Add row" 
                      nzType="plus" 
                      (click)="addRow()"
                      nzTheme="outline">
                    </span>
                  </a>
                  <nz-divider nzType="vertical"></nz-divider>
                  <a>
                    <span 
                      nz-icon 
                      title="Copy row" 
                      nzType="copy" 
                      (click)="copyRow(i)"
                      nzTheme="outline">
                    </span>
                  </a>
                  <nz-divider nzType="vertical"></nz-divider>
                  <a>
                    <span
                      nz-icon
                      title="Delete row"
                      nzType="delete"
                      nzTheme="outline"
                      (click)="deleteRow(i)">
                    </span>
                  </a>
                  <nz-divider nzType="vertical"></nz-divider>
                  <a>
                    <span
                      nz-icon
                      title="Reset row"
                      nzType="reload"
                      nzTheme="outline"
                      (click)="resetRow(i)">
                    </span>
                  </a>
                </td>
              </tr>
            </tbody>
          </nz-table>
        </div>

        <nz-row [nzGutter]="16">
          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="federal_tax_id">
                25. Federal Tax ID
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input
                  id="federal_tax_id"
                  formControlName="federal_tax_id"
                  readonly
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>
      
          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="ssn_ein">
                25b. SSN / EIN
              </nz-form-label>
              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <ng-container *ngIf="isViewMode; else editSsnEin">
                  <input
                    nz-input
                    readonly
                    [value]="getSsnEinLabel(form.get('ssn_ein')?.value)"
                    placeholder="SSN / EIN"
                  />
                </ng-container>
                <ng-template #editSsnEin>
                  <nz-select 
                    style="width: 100%;" 
                    nzShowSearch 
                    id="ssn_ein"
                    nzPlaceHolder="Select SSN / EIN"
                    formControlName="ssn_ein">
                    <nz-option 
                      *ngFor="let option of ssnEinOptions"
                      [nzLabel]="option.label" 
                      [nzValue]="option.value">
                    </nz-option>   
                  </nz-select>
                </ng-template>
              </nz-form-control>
            </nz-form-item>
          </nz-col>        

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="patient_account_number">
                26. Patient's Account Number
              </nz-form-label>

              <nz-form-control 
                [nzSpan]="24">
                <input 
                  nz-input
                  id="patient_account_number"
                  [readonly]="isViewMode"
                  formControlName="patient_account_number"
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="total_charge">
                28. Total Charge
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input 
                  type="number"
                  id="total_charge" 
                  formControlName="total_charge" 
                  readonly 
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="amount_paid">
                29. Amount Paid
              </nz-form-label>

              <nz-form-control 
                [nzSpan]="24">
                <input
                  type="number"
                  nz-input 
                  id="amount_paid"
                  [readonly]="isViewMode"
                  formControlName="amount_paid" 
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" nzFor="signature_doctor">
                31. Signature Doctor
              </nz-form-label>
              <nz-form-control 
                [nzErrorTip]="errorTemplate" [nzSpan]="24">
                <ng-container *ngIf="isViewMode; else editSignatureDoctor">
                  <input 
                    nz-input 
                    readonly
                    [value]="getSignatureDoctorLabel(form.get('signature_doctor')?.value)"
                  />
                </ng-container>
                <ng-template #editSignatureDoctor>
                  <nz-select 
                    style="width: 100%;" 
                    id="signature_doctor"
                    nzPlaceHolder="Select Signature Doctor"
                    formControlName="signature_doctor">
                    <nz-option 
                      *ngFor="let option of signatureOptions"
                      [nzLabel]="option.label" 
                      [nzValue]="option.value">
                    </nz-option>   
                  </nz-select>
                </ng-template>
              </nz-form-control>
            </nz-form-item>
          </nz-col>        
        </nz-row>
        
        <nz-row [nzGutter]="16">    
          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="date_signature_doctor">
                31b. Date Signature Doctor
              </nz-form-label>
              <nz-form-control 
                [nzErrorTip]="errorTemplate" 
                [nzSpan]="24">
                <ng-container *ngIf="isViewMode; else editDate">
                  <input
                    nz-input
                    readonly
                    [value]="form.get('date_signature_doctor')?.value | date:'MM-dd-yyyy'"
                  />
                </ng-container>
                <ng-template #editDate>
                  <nz-date-picker 
                    style="width: 100%;"
                    nzFormat="MM-dd-YYYY" 
                    formControlName="date_signature_doctor"
                    [nzDisabledDate]="disabledDate">
                  </nz-date-picker>
                </ng-template>
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="service_facility_location">
                32. Service Facility Location
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate" 
                [nzSpan]="24">
                <ng-container *ngIf="isViewMode; else selectAddress">
                  <input
                    nz-input
                    id="service_facility_location"
                    formControlName="service_facility_location"
                    readonly
                  />
                </ng-container>

                <ng-template #selectAddress>
                  <nz-select 
                    id="service_facility_location"
                    formControlName="service_facility_location"
                    nzShowSearch
                    nzPlaceHolder="Select Address">
                    <nz-option 
                      *ngFor="let locality of localities" 
                      [nzValue]="locality.address" 
                      [nzLabel]="locality.name + ' - ' + locality.address">
                    </nz-option>
                  </nz-select>
                </ng-template>
              </nz-form-control>
            </nz-form-item>
          </nz-col>
          
          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="service_facility_npi">
                32a. Service Facility NPI
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate" 
                [nzSpan]="24">
                <ng-container *ngIf="isViewMode; else selectTemplate">
                  <input
                    nz-input
                    id="service_facility_npi"
                    formControlName="service_facility_npi"
                    [readonly]="isViewMode"
                  />
                </ng-container>

                <ng-template #selectTemplate>
                  <nz-select 
                    id="service_facility_npi"
                    formControlName="service_facility_npi"
                    nzShowSearch
                    nzPlaceHolder="Select Npi">
                    <nz-option 
                      *ngFor="let doctor of doctors" 
                      [nzValue]="doctor.npi" 
                      [nzLabel]="doctor.first_name + ' - ' + doctor.npi">
                    </nz-option>
                  </nz-select>
                </ng-template>
              </nz-form-control>
            </nz-form-item>
          </nz-col>        

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="billing_provider_phone">
                33. Billing Provider Phone
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input 
                  id="billing_provider_phone" 
                  formControlName="billing_provider_phone"
                  readonly
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="billing_provider_npi">
                33a. Billing Provider NPI
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input 
                  id="billing_provider_npi" 
                  formControlName="billing_provider_npi" 
                  readonly
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col> 

          <nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label 
                [nzSpan]="24" 
                nzFor="billing_provider_address">
                33b. Billing Provider Address
              </nz-form-label>

              <nz-form-control 
                [nzErrorTip]="errorTemplate"
                [nzSpan]="24">
                <input 
                  nz-input 
                  id="billing_provider_address" 
                  formControlName="billing_provider_address"
                  readonly 
                />
              </nz-form-control>
            </nz-form-item>
          </nz-col> 
        </nz-row> 
        
        <ng-template #errorTemplate let-control>
          <span *ngIf="control && getErrorMessage(control)">
            {{ getErrorMessage(control) }}
          </span>
        </ng-template>
      </form>
    </nz-spin>
  </nz-card>
</div>

 <!-- <nz-col [nzSpan]="6">
        <nz-form-item>
          <nz-form-label 
            [nzSpan]="8" 
            nzFor="insured_address">
            7. Insured's Address
          </nz-form-label>

          <nz-form-control 
            [nzSpan]="16">
            <input 
              nz-input
              id="insured_address"
              formControlName="insured_address"
              readonly
            />
          </nz-form-control>
        </nz-form-item>
      </nz-col> -->

      <!-- <nz-col [nzSpan]="5">
        <nz-form-item>
          <nz-form-label 
            [nzSpan]="8" 
            nzFor="insured_city">
            7. Insured's City
          </nz-form-label>

          <nz-form-control 
            [nzSpan]="16">
            <input 
              nz-input 
              id="insured_city" 
              formControlName="insured_city" 
              readonly 
            />
          </nz-form-control>
        </nz-form-item>
      </nz-col> -->
    
      <!-- <nz-col [nzSpan]="5">
        <nz-form-item>
          <nz-form-label 
            [nzSpan]="8" 
            nzFor="insured_state">
            7. Insured's State
          </nz-form-label>

          <nz-form-control [nzSpan]="16">
            <input 
              nz-input 
              id="insured_state" 
              formControlName="insured_state" 
              readonly 
            />
          </nz-form-control>
        </nz-form-item>
      </nz-col> -->
    
    <!-- <nz-divider nzType="horizontal"></nz-divider> -->
    
    <!-- <nz-row [nzGutter]="16"> -->
      <!-- <nz-col [nzSpan]="8">
        <nz-form-item>
          <nz-form-label 
            [nzSpan]="8" 
            nzFor="insured_zip_code">
            7. Insured's Zip Code
          </nz-form-label>

          <nz-form-control 
            [nzSpan]="16">
            <input 
              nz-input
              id="insured_zip_code"
              formControlName="insured_zip_code"
              readonly
            />
          </nz-form-control>
        </nz-form-item>
      </nz-col> -->

      <!-- <nz-col [nzSpan]="8">
        <nz-form-item>
          <nz-form-label 
            [nzSpan]="8" 
            nzFor="insured_phone">
            7. Insured's Phone
          </nz-form-label>

          <nz-form-control 
            [nzSpan]="16">
            <input 
              nz-input
              id="insured_phone"
              formControlName="insured_phone"
              readonly
            />
          </nz-form-control>
        </nz-form-item>
      </nz-col> -->

      <!-- <nz-col [nzSpan]="8">
        <nz-form-item>
          <nz-form-label 
            [nzSpan]="8" 
            nzFor="other_insured_name">
            9. Other Insured's Name
          </nz-form-label>

          <nz-form-control 
            [nzSpan]="16">
            <input 
              nz-input
              id="other_insured_name"
              formControlName="other_insured_name"
            />
          </nz-form-control>
        </nz-form-item>
      </nz-col> -->
    <!-- </nz-row>     -->

    <!-- <nz-divider nzType="horizontal"></nz-divider> -->

    <!-- <nz-row [nzGutter]="16"> -->
      <!-- <nz-col [nzSpan]="8">
        <nz-form-item>
          <nz-form-label 
            [nzSpan]="8" 
            nzFor="other_insured_name_policy_group">
            9a. Other Insured's or Group Number
          </nz-form-label>

          <nz-form-control 
            [nzSpan]="16">
            <input 
              nz-input
              id="other_insured_name_policy_group"
              formControlName="other_insured_name_policy_group"
              readonly
            />
          </nz-form-control>
        </nz-form-item>
      </nz-col> -->

      <!-- <nz-col [nzSpan]="8">
        <nz-form-item>
          <nz-form-label 
            [nzSpan]="8" 
            nzFor="insurance_plan_name">
            9d. Insurance Plan Name
          </nz-form-label>

          <nz-form-control 
            [nzSpan]="16">
            <input 
              nz-input
              id="insurance_plan_name"
              formControlName="insurance_plan_name"
              readonly
            />
          </nz-form-control>
        </nz-form-item>
      </nz-col> -->

      <!-- <nz-col [nzSpan]="8">
        <nz-form-item>
          <nz-form-label 
            [nzSpan]="8" 
            nzFor="employment">
            10a. Employment
          </nz-form-label>

          <nz-form-control [nzSpan]="16">
            <nz-select 
              style="width: 100%;" 
              nzShowSearch 
              id="employment"
              nzPlaceHolder="Select Employment"
              formControlName="employment">
              <nz-option 
                nzLabel="YES" [nzValue]="1">
              </nz-option>
              <nz-option 
                nzLabel="NO" [nzValue]="2">
              </nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </nz-col> -->
    <!-- </nz-row>     -->

    <!-- <nz-divider nzType="horizontal"></nz-divider> -->

    <!-- <nz-row [nzGutter]="16"> -->
      <!-- <nz-col [nzSpan]="8">
        <nz-form-item>
          <nz-form-label 
            [nzSpan]="8" 
            nzFor="auto_accident">
            10b. Auto Accident
          </nz-form-label>

          <nz-form-control 
            [nzSpan]="16">
            <nz-select 
              style="width: 100%;" 
              nzShowSearch 
              id="auto_accident"
              nzPlaceHolder="Select Auto Accident"
              formControlName="auto_accident">
              <nz-option 
                nzLabel="YES" [nzValue]="1">
              </nz-option>
              <nz-option 
                nzLabel="NO" [nzValue]="2">
              </nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </nz-col> -->

      <!-- <nz-col [nzSpan]="8">
        <nz-form-item>
          <nz-form-label 
            [nzSpan]="8" 
            nzFor="other_accident">
            10c. Other Accident
          </nz-form-label>

          <nz-form-control [nzSpan]="16">
            <nz-select 
              style="width: 100%;" 
              nzShowSearch 
              id="other_accident"
              nzPlaceHolder="Select Other Accident"
              formControlName="other_accident">
              <nz-option 
                nzLabel="YES" [nzValue]="1">
              </nz-option>
              <nz-option 
                nzLabel="NO" [nzValue]="2">
              </nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </nz-col> -->